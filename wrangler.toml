# Wrangler configuration for the TSD site
# Add your account details and project settings as needed.
# This file includes an example D1 binding for the 'tsd_updates' database.

name = "tsdmyanmar"
compatibility_date = "2026-01-12"

# Required for Git-based Cloudflare Pages deployments to read bindings from this file.
# Must match the build script output directory (npm run build → dist/).
pages_build_output_dir = "dist"

# Bind your Cloudflare D1 database to the environment variable UPDATES_DB
[[d1_databases]]
binding = "UPDATES_DB"
database_name = "tsd_updates"
# Pin to specific D1 database (useful for local dev)
database_id = "bb376db4-497c-4ac3-9761-675b8a537422"

# Auth: Cloudflare Access (Zero Trust) protects admin routes at the edge.
# Workers verify identity via cf-access-authenticated-user-email header against env.ADMIN_EMAIL.
# Bind Cloudflare R2 bucket for image uploads
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "tsd-images"

[vars]
# ADMIN_EMAIL — the Cloudflare Access verified email allowed to use admin APIs.
# For local dev, set here. For production, set via Cloudflare dashboard (Settings > Environment Variables)
# so it is never committed to the repository.
ADMIN_EMAIL = "admin@tsdmyanmar.org"

# DEV_MODE — set to "true" for local development to bypass Cloudflare Access auth.
# NEVER set this in production. For local dev, override with `wrangler pages dev --var DEV_MODE:true`
# DEV_MODE = "true"

# Optional: add other settings such as zone_id, account_id, or site configuration
# Example:
# account_id = "your-account-id"
# route = "https://example.com/*"
# [site]
#   bucket = "public"
#   entry-point = "./"